---
title             : "Data Visdualization on Madarin Vowels"
shorttitle        : "Final Project in EDLD 610: Introduction to Data Science with R"

author: 
  - name          : "Teresa Chen"
    affiliation   : "3"
    corresponding : yes    # Define only one corresponding author
    address       : "Rm.52 Gerlnger Annex, University of Oregon, OR 9740"
    email         : "szuhuac@uoregon.edu"
  - name          : "Jun Lang"
    affiliation   : "2"
  - name          : "Steffi Hung"
    affiliation   : "2"
  - name          : "Ting-fen Lin"
    affiliation   : "1"
    
affiliation:
  - id            : "1"
    institution   : "Department of Human Physiology"
  - id            : "2"
    institution   : "Department of East Asia Linguistic Language"
  - id            : "3"
    institution   : "Department of Communication Disorder"

authornote: |
  Steffi and Jun are the owner of the dataset. They have the correct permissions to make the dataset public.

abstract: |
  One or two sentences providing a **basic introduction** to the field,  comprehensible to a scientist in any discipline.
  
  Two to three sentences of **more detailed background**, comprehensible  to scientists in related disciplines.
  
  One sentence clearly stating the **general problem** being addressed by  this particular study.
  
  One sentence summarizing the main result (with the words "**here we show**" or their equivalent).
  
  Two or three sentences explaining what the **main result** reveals in direct comparison to what was thought to be the case previously, or how the  main result adds to previous knowledge.
  
  One or two sentences to put the results into a more **general context**.
  
  Two or three sentences to provide a **broader perspective**, readily comprehensible to a scientist in any discipline.
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "Madarin, Vowels, Native speaker, Non-native speaker"


bibliography      : ["r-references.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man, fleqn, noextraspace"
output            : 
  papaja::apa6_pdf:
    toc: true
    toc_depth: 5
---

```{r setup, include = FALSE}
library("papaja")
library("tidyverse")
library("rio")
library("here")
library("janitor")
library("tinytex")
library("kableExtra")
library("knitr")
knitr::opts_chunk$set(warning = FALSE,
                      message = FALSE,
                      error = TRUE,
                      fig.width = 6.5,
                      fig.height = 8
                      )
theme_set(theme_minimal(base_size = 8))
```

```{r load_data, include = FALSE}
df <- import(here("data", "data.xlsx"),
             setclass = "tbl_df")

head(df)

```
```{r tidy_data, include = FALSE}
tidy_df <- df %>% 
  clean_names(case = "snake") %>% 
  separate(x_1, into = c("group", "id"),
           sep = "(?<=[A-Za-z])(?=[0-9])") %>%  #seperate x_1 to group (NS vs. NNS) & id
  mutate(id = case_when(
   group == "NNS" & id == '1' ~  '7',
   group == "NNS" & id == '2' ~  '8',
   group == "NNS" & id == '3' ~  '9',
   group == "NNS" & id == '4' ~  '10',
   group == "NNS" & id == '5' ~  '11',
   group == "NNS" & id == '6' ~  '12',
   TRUE ~ id
  )) %>%   # fix duplicate id numbers
  mutate( formant_type = as.factor(mean), mean = NULL,
          group = as.factor(group),
          id = as.numeric(id),
          yi = i, i = NULL,
          yu = y, y = NULL,
          wu = u, u = NULL,
          ye = e, e = NULL,
          wo = o, o = NULL,
          en = x_u_0259, x_u_0259 = NULL,
          e = x_u_0264, x_u_0264 = NULL,
          ai = a, a = NULL,
          ao = x_u_0251, x_u_0251 = NULL) %>%  #rename variables & set the variable types
  gather(vowel, value, -1:-6) %>%  
  mutate(vowel = as.factor(vowel))%>% 
  spread(formant_type, value) %>% 
  filter(gender == "F") %>%  #quite redundant here (all females), just for meet the requirement
  select(id, group, age, height, vowel, F1, F2) %>% #reorder variables & discard gender
  arrange(id)
  
head(tidy_df)


```
```{r smr_data, include= FALSE}
smry_df <- tidy_df %>% 
  group_by(group, vowel) %>% 
  summarize_at(vars(F1, F2), funs(mean, sd)) 
  

head(smry_df)
```


\newpage
# Introduction
It is generally agreed that Mandarin Chinese has a five-vowel system (e.g., Lin, 2007). These five vowels are [i], [y], [u], [ə] and [a]. Among these vowels, the mid vowel /ə/ has four allophones: [e], [o], [ə] and [ɤ]; and the low vowel /a/ has two allophones: [a] and [ɑ]. However, little attention has been paid to the individual variances when producing these nine vowels. Few researchers did empirical studies to examine Lin’s (2007) vowel space of Chinese. In order to fill these gaps, this study investigates the vowel distribution of native Chinese speakers, aiming to determine whether native Chinese speakers show similar patterns when producing Chinese vowels and whether their patterns look similar to Lin’s proposal of Chinese vowel chart. In addition, this current work examines the vowel distribution of American English learners of Chinese, with the purpose of finding out whether non-native speakers perform similarly to native speakers in the vowel production.

# Methods
##Participants
Six female native (L1) Mandarin speakers and six female non-native (L2) Mandarin speakers participated in the study. The mean age of the L1 Mandarin speakers was 26.3 (range: 23-30) and that of the L2 Mandarin speakers was 22.3 (range: 18-28). Among L1 Mandarin speakers, two speakers were from northern Mainland China (Beijing and Tianjin), three speakers were from southern Mainland China (Nanjing, Chengdu and Chongqing), and one speaker were from Taiwan. The Taiwanese participants identified Mandarin as the most fluent language. Moreover, it should be noted that one of the native speaker's Chinese dialect, Taiwanese (Taiwan Southern Min dialect), is mutually unintelligible with Mandarin. All the six L2 Mandarin speakers’ native language was American English. In addition, they were all novice-low learners who enrolled in first-year accelerated Chinese language course at the same university. They had learned Mandarin for six months and none of them had any study-abroad experience.

## Material
We prepared nine Chinese sentences for speech materials (Appendix 1). Each sentence includes one of the following nine vowels: [i], [y], [u], [e], [o], [ə], [ɤ], [a], [ɑ]. Each vowel appears after the aspirated bilabial stop [pʰ] with a high tone (55). It is important to note that four allophones of the mid vowel are complementary distributed as shown in the phonological rules below:
	    ə → [e] / __ i  or  j__ # or  ɥ __ #                    ə →  [ə] / __ n or __ ŋ 
    	ə → [o] / __ u or w __#                                   ə → [ɤ] / C __ #                 
The two allophones of the low vowel /a/ are also constrained by phonological rules:
	    a → [a] / __ #  or  __i or   __n                       a →  [ɑ]/ __u or __ŋ
Therefore, besides [pʰi], [pʰy], [pʰu] for high vowel phonemes, we designed [pʰei] [pʰ ən] [pʰ ou] [pʰ ɤ] for mid vowels and [pʰa] [pʰau] for low vowels. 

## Procedure
  Productions were elicited in a sentence-repetition oral task. Non-native speakers (NNS) and native Chinese speakers (NS) were asked to read the sentences twice. All participants read the speech materials for practice once before recording. Recordings were made in a quiet study room in the library using Praat Sound Recorder with 44,100 Hz sampling frequency, and then these recordings were saved as wav files on a laptop. 
  Formant 1 (F1) and Formant 2 (F2) were measured in the vowel mid-point for each vowel shown in the spectrogram. All measurement was conducted using Praat program on the same laptop. After the measurement, the mean F1 and F2 values were plotted in charts using the program R to generate vowel distribution for each speaker. 

# Results and discussion
3.1 Native speaker patterns
  Table 1 shows the mean F1 and F2 values of nine Chinese vowels for native speakers. Regarding F2 values, data shows that [i] had the highest F2 values for all native speakers, and [u] had the lowest F2 values for NS2 and NS3, but not for NS1. As for F1 values, three NS also had different lowest and highest values. While [i] had the lowest F1 value and [ɑ] had the highest F1 value for NS1 and NS3, NS2’s [y] had the lowest F1 value and her [a] had the highest F1 value. 
  Clearer vowel distribution for each native speaker can be seen in the formant plots (Figure 1-3). According to the “vowel dispersion principle”, the vowel quadrilateral can be viewed as “a perceptual space in which vowels are located in the oral cavity” (Ashby and Maidment, 2005). In this study, the vowel quadrilateral is shown as formant plots where the Y-axis is F1 (Hz) that corresponds to the height of the tongue position; while the X-axis is F2 (Hz) that indicates the backness of the tongue position for each vowel. 
  Figure 1-3 show that the distribution of NS vowels is roughly similar to Lin’s (2007) vowel space for Standard Chinese (SC). It is clear to see that [i] and [u] are high vowels, [e] [ə] [o] are mid vowels, and [a] [ɑ] are low vowels in Figure 1-3. However, we can find two minor individual differences between NS vowel distribution in our study and what Lin proposed for SC vowel distribution. First, F1 values show that NS’s mid vowel [ə] was much higher than that in SC vowel distribution, indicating the tongue position for [ə] is lower than Lin’s proposal. Second, NS’s F2 values for low vowels [a] and [ɑ] are slightly different from that of Lin’s pattern, which means that [a] was not that front and that [ɑ] was not that back for all three NS.
  When comparing NS vowel distribution with one another, formant plots show a similar pattern given the height and the backness of the tongue position in vowel production. First, all these nine vowels are located in different positions without overlapping for each NS, and [ə] was spaced in the middle of each chart. Second, F1 values show that all NS had [i][y][u] as high vowels and [a][ɑ] as low vowels. Third, F2 values demonstrates that all NS had [i][y][e] as front vowels and [u][o] as back vowels. F2 values for four allophones of the mid vowel /ə/ followed the order of [e] > [ə]> [ɤ] > [o] for each NS, indicating the frontness for these mid vowels also followed the same pattern, with [e] being the frontest and [o] being the most back. The F2 values for two low vowels for each NS show the pattern of [a] > [ɑ], showing that [a] was spaced fronter than [ɑ].
	Despite these similarities, there are two main differences in F1 and F2 values for mid vowels and low vowels in NS data. The first difference is regarding F1 values of mid vowels. The F1 values for both NS1 and NS3 followed [o] < [e] < [ɤ] < [ə], with F1 value of [o] being the lowest and that of [ə] being the highest; whereas NS2’s [ɤ] had the lowest F1 value, and her [e] and [o] had similar F1 values. This difference might be due to the fact that [pʰ ɤ] is a non-existing sound in Mandarin Chinese. In this case, NS may pronounce it in different ways causing different F1 values of this sound. The second difference is in the F1 and F2 values for low vowels. With regard to F1 values, NS 1’s front [a] had a lower value than that of the back [ɑ], but NS 2’s front [a] had a higher value than that of the back [ɑ]. NS 3’s low vowels had similar F1 values. As for F2 values, NS 3’s low vowels were spaced further separated than NS1 and NS2’s low vowels. Moreover, NS1 performed [a] and [ɑ] fronter than other NS did, while NS 2’s [a] and [ɑ] were spaced backer. The data shows that, although Chinese native speakers differentiate front low vowel and back low vowel when they appear in different contexts, the backness and height of these low vowel may vary individually due to the comparatively larger space of low tongue position in oral cavity. 

```{r table1, echo= FALSE}
smry_df %>% 
  kable(format = "latex",
        digits = 2,
        caption = "Formant by volwels among non-native and native groups",
        booktabs = T) 

  # kable_styling(bootstrap_options = "striped", 
  #               full_width = F) 
```

```{r figure1, echo= FALSE}
# NS1
F1 = c(270, 326, 320, 583, 553, 730, 634, 808, 832)
F2 = c(3041, 2678, 927, 2548, 872, 1803, 1078, 1802, 1531)
names = c("[i]","[y]", "[u]","[e]","[o]","[ə]","[ɤ]","[a]","[ɑ]")
# NS1- linear plot
plot(F2,F1,xlim=c(3100,700),ylim=c(1000,200), type="n") > text(F2,F1,names)
```
Figure 1


```{r figure2, echo= FALSE}
# NS2
F1 = c(321, 307, 341, 537, 563, 710, 482, 988, 812)
F2 = c(2909, 2383, 836, 2347, 958, 1863, 1201, 1383, 1221)
names = c("[i]","[y]", "[u]","[e]","[o]","[ə]","[ɤ]","[a]","[ɑ]")
# NS2- linear plot
plot(F2,F1,xlim=c(3100,700),ylim=c(1000,200), type="n") > text(F2,F1,names)
```
Figure 2


```{r figure3, echo= FALSE}
# NS3
F1 = c(300, 316, 321, 547, 472, 740, 553, 927, 932)
F2 = c(2899, 2481, 776, 2694, 821, 1812, 1282, 1696, 1191)
names = c("[i]","[y]", "[u]","[e]","[o]","[ə]","[ɤ]","[a]","[ɑ]")
# NS3- linear plot
plot(F2,F1,xlim=c(3100,700),ylim=c(1000,200), type="n") > text(F2,F1,names)
```
Figure 3

3.2	Second language examination
  When examining the formant plots for each NNS, we can see how NNS participants performed differently from NS in the vowel production. The first difference is about high vowels [y] and [u]. NNS’s [y] shows notable deviation from native patterns. In NNS’s vowel distribution, [y] was located further backer than NS’s [y], indicating that NNS’s [y] is not a front vowel as shown in NS’s formant plots. It is probably because NS tend to round their lips when producing [y], while NNS’s lip gestures were not as rounded as NS did. Similarly, F1 values for NNS’s [u] shows that the location of [u] was not as high as that in NS’s patterns, especially for NNS 3 whose [u] was located so low that it was overlapping with mid vowel [o].  This finding does not only suggest that NNS do not clearly differentiate [u] and [o], but also shows the overall L1 phonological transfer from English [ʊ] to Chinese [u]. 
  Second, the distribution of NNS’s low vowels also shows a remarkable variation from native patterns. While NS’s [a] and [ɑ] were distinguishable in the formant plots, the locations of NNS’s [a] and [ɑ] were so close that they almost overlaid with each other. The difficulty of differentiating Chinese [a] and [ɑ] may also be attributed to their L1 phonological transfer. In English vowel chart (Roach, 2004, p.242), [ɑ] is the only low back vowel. Therefore, NNS’s confusion between [a] and [ɑ] suggests the negative influence of learners’ first language.
  Apart from the notable deviation from native patterns, there are two individual differences related to mid vowels. First, while NS performed [e] as a front mid vowel, F1 values shows that NNS 2’s [e] was even higher than her [u]. This suggests that she produced [e] as a high vowel and that her [u] was not sufficiently high to be a high vowel. In NNS 1’s case, F2 value for her [e] was not as high as that in NS patterns, showing that her [e] was produced backer in the oral cavity than NS’ s [e]. Second, we noticed that [ɤ] was generally spaced much higher than [ə] in NS’s pattern, and the difference of F1 values for NNS’s [ɤ] and [ə] was quite small. The [ɤ] and [ə] produced by NNS1 were almost overlapping with each other, showing that these two mid vowels were not distinguishable in NNS patterns. The confusion between [ɤ] and [ə] may be caused by the non-existence of [ɤ] their L1 phonetic inventory. Therefore, there is a tendency for native English speakers to confuse [ɤ] with [ə].
  Figure 4-6 show that the only similarity across three NNS is that they all had a high F2 value for [i]. It seems like NNS’s [i] approaches a native-like pattern, but when observing the data closely, we found that NS and NNS had different mean values of F1 and F2. NNS’s mean F1 value was higher than NS’s [i], indicating that [i] performed by NNS was slightly lower than NS. NNS’s mean F2 value for [i] was lower than NS’s [i]. It means the location of [i] for NNS was actually not as front as NS’s [i]. Therefore, we can only say that their [i] show a more native-like pattern than other eight vowels. 

```{r figure4, echo= FALSE}
##figure 4 
tidy_df %>% 
  ggplot(aes(x = F2, y = F1, color = vowel)) + 
  geom_point(size = 3) +
  scale_x_reverse() +  #reverse x and y to meet the perception of sounds
  scale_y_reverse() +
  facet_wrap(~ group) + 
  theme_classic() +
  scale_color_discrete(breaks = c("yi", "yu", 
                                  "wu", "ye", 
                                  "wo", "en", 
                                  "e", "ai", 
                                  "ao"))  #reorder vowel based on IPA order
```

```{r figure5, echo= FALSE}
smry_df %>% 
  ggplot(aes(x = F2_mean, y = F1_mean, 
             label = vowel, color = group)) +
    geom_label() +
    scale_x_reverse() +  
    scale_y_reverse() +
    theme_classic()

```

```{r figure6, echo = FALSE}
ggplot(data = tidy_df, aes(x = F2, y = F1 )) +
  geom_label(data = smry_df, aes(x = F2_mean, y = F1_mean, 
                                 label = vowel, fill = group),
             alpha = 0.2) +
  geom_point(aes(color = vowel, shape = group),
             size = 3, alpha = 0.4) +
  stat_ellipse(aes(color = vowel), level = 0.67) +
  scale_x_reverse() +  
  scale_y_reverse() +
  theme_classic() +
  guides(color = FALSE)

```

# Conclusion
  This study examined vowel distributions of three Chinese native speakers’ as well as three non-native learners of Chinese. The first research purpose concerns whether native speakers show similar patterns of vowel distribution. Data shows that three native participants presented similar patterns of vowel production, despite individual variances of four allophones of the mid vowels. NS vowel distribution also resembles what Lin (2007) proposed for Chinese vowel space to some extent. It is clear that they have the same high vowels [i][y][u], mid vowels [e][ə][ɤ][o] and low vowels [a][ɑ]. They also have the same front vowel [i][e] and back vowel [u][o], but NS’s [a] and [ɑ] were distributed closer to each other in the central than those Lin’s vowel chart. The findings suggest, although NS show similar patterns in vowel production, mid vowels and low vowels may present individual variances.
  As for second language examination of vowel production, we concluded that none of the non-native participants showed an overall native-like pattern in the vowel production, but their [i] showed a more native-like pattern comparing to other vowels. Data also show that the most remarkable deviations of L2 learners’ vowel distribution patterns from native patterns are: (1) the backness of [y], which was located further back in the oral cavity; and (2) the overall nearly overlapping patterns of [a] and [ɑ]. The non-existence of [y] and [a] in their L1 can be accounted for these notable deviations. NNS’s L1 phonological transfer from English [ʊ] to Chinese [u] and the transfer from English [ə] to Chinese [ɤ] can also explain L2 learners’ confusion of these sounds. Future research should consider a larger sample of subjects to observe more accurate differences between NS and NNS vowel distribution. 

\newpage

# References
```{r create_r-references}
r_refs(file = "r-references.bib")
```

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>
\endgroup
